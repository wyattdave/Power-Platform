{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\r\n\tlet wb1 = workbook.getWorksheet(\"Sheet1\");\r\n\tlet wb2 = workbook.addWorksheet();\r\n\tlet i = 1;\r\n\tlet r=1;\r\n\tlet c=3;\r\n\tlet rowCount = wb1.getUsedRange().getRowCount();\r\n\tlet colCount = wb1.getUsedRange().getColumnCount();\r\n\tconsole.log(rowCount+\" \"+colCount);\r\n\tlet headersMain =[[\"Email\",\"Subject\"]]\r\n\twb1.getRange(\"A1:B1\").setValue(headersMain);\r\n\tlet headers=[[\"ID\",\"Email\",\"Change\",\"With\"]]\r\n\twb2.getRange(\"A1:D1\").setValue(headers);\r\n\r\n\tfor (r=1;r <rowCount;r++){\r\n\r\n\t\tfor(c=2;c<colCount;c++){\r\n\t\t\r\n\t\t\twb2.getCell(i, 0).setValue(r);\r\n\t\t\twb2.getCell(i, 1).setValue(wb1.getCell(r, 0).getValue());\r\n\t\t\twb2.getCell(i, 2).setValue(wb1.getCell(0, c).getValue());\r\n\t\t\twb2.getCell(i, 3).setValue(wb1.getCell(r, c).getValue());\r\n\t\t\ti++;\r\n\t\t\r\n\t\t}\r\n\r\n\t}\r\n\twb1.getRange(\"A:A\").insert(ExcelScript.InsertShiftDirection.right);\r\n\twb1.getRange(\"A1\").setValue(\"mainID\");\r\n\twb1.getRange(\"A2\").setFormulaLocal(\"=row(A1)\");\r\n\twb1.getRange(\"A2\").autoFill();\r\n\r\n\tlet table1 = workbook.addTable(wb1.getRange(\"A1:F\"+rowCount), true);\r\n\ttable1.setName(\"mainTable\");\r\n\tlet table2 =workbook.addTable(wb2.getRange(\"A1:D\" + i), true);\r\n\ttable2.setName(\"PivotTable\");\r\n\twb2.setName(\"Pivot\");\r\n\r\n\treturn(rowCount-1);\r\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"number\"}}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}