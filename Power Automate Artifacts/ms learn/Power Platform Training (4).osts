{"version":"0.2.0","body":"\nfunction main(\n  workbook: ExcelScript.Workbook,\n  aModules: intModules[],\n  aCerts: intCertificates[],\n  aRequiredModules: intCollection[],\n  aRequiredCerts: intRequired[],\n  aRequiredSkills: intRequired[],\n  aSkills: intAppliedSkills[]\n  ) {\n\n  let oReturn: intReturn;\n\n  try {\n    //create arrays\n    let aRequired: intCollData[] = [];\n    let aMissing: intCollData[] = [];\n\n    //loop over all sections in collection\n    aRequiredModules.forEach(section => {\n      //loop over all modules in section\n      section.items.forEach(item => {\n        //to to required seperate arry to make debugging easier\n        aRequired.push(item.data\n        )\n      })\n    })\n\n  //loop over required array\n    aRequired.forEach(item => {\n      //if cant find requred module in transcript add to missign array\n      if (!aModules.find(m => (m.uid == item.uid))){\n        aMissing.push(item);\n      }            \n    })\n\n    //loop over rerquired certificates, if cant find in transcript add to missing array\n    aRequiredCerts.forEach(item =>{\n      if (!aCerts.find(c => (c.name == item.title))) {\n        aMissing.push({\n          rawUrl: \"\",\n          uid: \"\",\n          title: item.title,\n          name: \"\"\n        });\n      }     \n    })\n\n//loop over rerquired applied skills, if cant find in transcript add to missing array\n    aRequiredSkills.forEach(item => {\n      if (!aSkills.find(skill => (skill.title == item.title))) {\n        aMissing.push({\n          rawUrl: \"\",\n          uid: \"\",\n          title: item.title,\n          name: \"\"\n        });\n      }\n    })\n    \n    //return object\n    oReturn = {\n      outcome: aMissing.length == 0,\n      message: \"\",\n      data: aMissing\n\n    }\n    return oReturn\n\n  } catch (err) {\n    let sError = JSON.stringify(err)\n    \n    oReturn = {\n      outcome: false,\n      message: JSON.stringify(err),\n      data: []\n\n    }\n  }finally{\n    return oReturn\n  }\n\n}\n\ninterface intReturn {\n  outcome: boolean,\n  message: string,\n  data: intCollData[]\n}\n\ninterface intCollection {\n  id: string,\n  listId: string,\n  name: string,\n  userId: string,\n  description: string,\n  items: {\n    id: string,\n    listId: string,\n    type: string,\n    data: intCollData\n  }[]\n}\n\ninterface intCollData {\n  rawUrl: string,\n  uid: string,\n  title: string,\n  name: string\n}\n\ninterface intModules {\n  uid: string,\n  title: string,\n  description: string,\n  durationInMinutes: number,\n  completedOn: string\n}\n\ninterface intCertificates {\n  name: string,\n  certificationNumber: string,\n  status: string,\n  dateEarned: string,\n  expiration: string\n}\n\ninterface intAppliedSkills {\n  credentialId: string,\n  title: string,\n  awardedOn: string\n}\n\ninterface intRequired{\n  title:string\n}\n","description":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"aModules\",\"index\":0},{\"name\":\"aCerts\",\"index\":1},{\"name\":\"aRequiredModules\",\"index\":2},{\"name\":\"aRequiredCerts\",\"index\":3},{\"name\":\"aRequiredSkills\",\"index\":4},{\"name\":\"aSkills\",\"index\":5}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"aModules\",\"aCerts\",\"aRequiredModules\",\"aRequiredCerts\",\"aRequiredSkills\",\"aSkills\"],\"properties\":{\"aModules\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"uid\":{\"type\":\"string\"},\"title\":{\"type\":\"string\"},\"description\":{\"type\":\"string\"},\"durationInMinutes\":{\"type\":\"number\"},\"completedOn\":{\"type\":\"string\"}}}},\"aCerts\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"name\":{\"type\":\"string\"},\"certificationNumber\":{\"type\":\"string\"},\"status\":{\"type\":\"string\"},\"dateEarned\":{\"type\":\"string\"},\"expiration\":{\"type\":\"string\"}}}},\"aRequiredModules\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"listId\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"userId\":{\"type\":\"string\"},\"description\":{\"type\":\"string\"},\"items\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"listId\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"},\"data\":{\"type\":\"object\",\"properties\":{\"rawUrl\":{\"type\":\"string\"},\"uid\":{\"type\":\"string\"},\"title\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"}}}}}}}}},\"aRequiredCerts\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"title\":{\"type\":\"string\"}}}},\"aRequiredSkills\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"title\":{\"type\":\"string\"}}}},\"aSkills\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"credentialId\":{\"type\":\"string\"},\"title\":{\"type\":\"string\"},\"awardedOn\":{\"type\":\"string\"}}}}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"object\",\"properties\":{\"outcome\":{\"type\":\"boolean\"},\"message\":{\"type\":\"string\"},\"data\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"rawUrl\":{\"type\":\"string\"},\"uid\":{\"type\":\"string\"},\"title\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"}}}}}}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"aModules\",\"comment\":\"\"},{\"name\":\"aCerts\",\"comment\":\"\"},{\"name\":\"aRequiredModules\",\"comment\":\"\"},{\"name\":\"aRequiredCerts\",\"comment\":\"\"},{\"name\":\"aRequiredSkills\",\"comment\":\"\"},{\"name\":\"aSkills\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}