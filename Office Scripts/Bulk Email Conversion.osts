{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\r\n\tlet tableRange = workbook.getWorksheet(\"Sheet1\").getUsedRange().getValues();\r\n\tlet rowCount = tableRange.length;\r\n\tlet colCount = tableRange[0].length;\r\n\tlet rowObject: child[]=[];\r\n\tlet rowObject2: parent[] = [];\r\n\r\n\tfor (let r=1;r<rowCount;r++){\r\n\t\tfor(let c=2;c<colCount;c++){\r\n\t\t\trowObject.push({\r\n\t\t\t\tID: r,\r\n\t\t\t\tEmail: tableRange[r][c].toString(),\r\n\t\t\t\tChange: tableRange[0][c].toString(),\r\n\t\t\t\tWith: tableRange[r][c].toString()\r\n\t\t\t})\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tfor(let i=1;i<rowCount;i++){\r\n\t\trowObject2.push({\r\n\t\t\tmainID: i.toString(),\r\n\t\t\tEmail: tableRange[i][0].toString(),\r\n\t\t\tSubject: tableRange[i][1].toString()\r\n\t\t})\r\n\t}\r\n\t\r\n\tlet oTables: response= {\r\n\t\tparentTable: rowObject2,\r\n\t\tchildTable: rowObject,\r\n\t\trows: rowCount-1\r\n\t};\r\n\treturn oTables;\r\n}\r\n\r\ninterface child {\r\n\tID: number,\r\n\tEmail: string,\r\n\tChange: string,\r\n\tWith: string\r\n}\r\ninterface parent {\r\n\tmainID: string,\r\n\tEmail: string,\r\n\tSubject: string\r\n}\r\ninterface response{\r\n\tparentTable: parent[],\r\n\tchildTable:child[],\r\n\trows:number\r\n}\r\n\r\n","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"object\",\"properties\":{\"parentTable\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"mainID\":{\"type\":\"string\"},\"Email\":{\"type\":\"string\"},\"Subject\":{\"type\":\"string\"}}}},\"childTable\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"ID\":{\"type\":\"number\"},\"Email\":{\"type\":\"string\"},\"Change\":{\"type\":\"string\"},\"With\":{\"type\":\"string\"}}}},\"rows\":{\"type\":\"number\"}}}}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}