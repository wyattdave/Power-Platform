{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook, csv: string) {\n    let sJson: string = \"[\";\n    let aHeaders: string[] = []\n    csv = csv.replace(/\\r/g, \"\");\n    let rows = csv.split(\"\\n\");\n    const csvRegex = /(?:,|\\n|^)(\"(?:(?:\"\")*[^\"]*)*\"|[^\",\\n]*|(?:\\n|$))/g\n    rows.forEach((value, index) => {\n        let rIndex=index;\n        if (value.length > 0) {\n            let row = value.match(csvRegex);\n\n            if (row[0].charAt(0) === ',') {\n                row.unshift(\"\");\n            }\n            if (index != 0) { sJson += \"{\" }\n\n            row.forEach((cell, index) => {\n                row[index] = cell.indexOf(\",\") === 0 ? cell.substr(1) : cell;\n                if (rIndex == 0) {\n                    aHeaders.push(row[index] .toString())\n                } else {\n                  if (Number(row[index])){\n                    sJson += '\"' + aHeaders[index] + '\":' + row[index] + ','\n                  } else if (row[index] == \"TRUE\" || row[index] == \"FALSE\"){\n                    sJson += '\"' + aHeaders[index] + '\":' + row[index].toLowerCase() + ','\n                  }else{\n                    sJson += '\"' + aHeaders[index] + '\":\"' + row[index].trim()  + '\",'\n                  }\n                }\n            });\n\n            if (index != 0) {\n                sJson = sJson.substring(0, sJson.length - 1);\n                sJson += \"},\"\n            }\n        }\n    });\n    sJson = sJson.substring(0, sJson.length - 1);\n    sJson += \"]\";\n    return (sJson);\n}\n\n\n","description":"","copilotMetadata":null,"parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"csv\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"csv\"],\"properties\":{\"csv\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"csv\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}